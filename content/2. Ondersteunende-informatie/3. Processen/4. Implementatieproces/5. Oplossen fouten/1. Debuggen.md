---
title:
  - 1. Debuggen
taxonomie:
  - io-28.2.Debuggen.OI
difficulty: 2
---

## Wat is debuggen?
Een bug is een fout in software. Hierdoor kan het programma vastlopen of verkeerde uitkomsten geven. Soms is dit zichtbaar, maar soms ook niet.

Debuggen is het opsporen en verhelpen van fouten in software. 

> [!TIP] Casus
> Annie maakt een rekenmachine. Eén van de functies is het berekenen van een gemiddelde. Ze 
> geeft als invoer: 1, 2, 4. De functie geeft geen foutmelding en geeft als resultaat 2. Dit is niet  
> juist, het zou bij benadering 2,3333 moeten zijn.
> ```cs
>   public double BerekenGemiddelde(int[] numbers)
>   {
>        int som = 0;
>
>       // Tel alle getallen op
>        foreach (var number in numbers)
>        {
>            som += number;
>        }
>
>        // Bepaal het gemiddelde
>        return som / numbers.Length;
>    }
>    ````
> De *reden* van de bug: 
> In C# wordt bij het delen van twee gehele getallen (`int`) het resultaat **afgerond naar beneden**.
> 
> De *oplossing* van de bug: 
> Annie heeft een **strategie** nodig om achter de fout te komen. Ze kiest voor het opzoeken van documentatie van de `/` operator (divisie). Daaruit blijkt dat ze een **cast** moet toepassen:
> ```cs
> return (double)som / numbers.Length;
>```

## Waaruit bestaat debuggen?
Debuggen bestaat uit een aantal stappen waarbij je verschillende technieken kunt gebruiken.
De stappen van debuggen bestaan uit:
1. Het *identificeren* van de symptomen: het crashen van een programma, onverwachte output, foutief gedrag
2. Het toepassen van tooling om de *locatie* van het probleem vast te stellen
3. Het *isoleren* van de specifieke code die het probleem veroorzaakt
4. De *inspectie* van code en variabelen om de oorzaak van het probleem vast te stellen
5. Oplossen van het probleem.

## Hoe werkt debuggen?
In deze paragraaf bekijken we hoe de debug stappen methodisch doorlopen kunnen worden om het probleem op te lossen.

### 1. Identificatie symptomen
Het eerste doel is het *identificeren* van het probleem. Dus eerst de symptomen goed bekijken. Dit kan door:
- de *foutmelding* te lezen
- de *stack trace* in de console te lezen
- de *logging* van de applicatie door te nemen

### 2. Locatie vaststellen
De volgende methoden zijn bruikbaar om de locatie van het probleem vast te stellen.
- *Rubberducking*, het probleem uitleggen aan een badeend. Een beproefde methode om je oplossingsvermogen te stimuleren.
- *Binary searching*. Halverwege de uitvoer van de code inspecteer je variabelen. Als deze juist zijn inspecteer je halverwege de eerste helft van de uitvoer, dus op een kwart. En zo verder. Hierdoor heb je meer kans om de fout in de code sneller te vinden.
- *Backtracing*, op de locatie waar symptomen zichtbaar worden terug zoeken in de code naar de oorzaak.

#### Tooling
Voor het vaststellen van de locatie gebruiken ontwikkelaars vaak tooling, zoals debuggers, loggers en linters.

Met *debuggers* kan stapsgewijs door de code worden gestapt. Bij elke stap kunnen de variabelen geïnspecteerd worden.
*breakpoint* worden geplaatst. Het programma wordt dan uitgevoerd vanaf de start en stopt bij het *breakpoint*, waarvandaan stapsgewijs doorgelopen kan worden, *stepping*.

### 3. Code isoleren
Als niet direct duidelijk is wat de oorzaak is dan kan het noodzakelijk zijn om de code te isoleren. Dit doe je door alleen het stukje 'probleem code' uit te voeren. Dit kan met behulp van een test, zoals een Unit test. Een andere manier is door de aanroepende functie steeds dezelfde statische waarde(n) mee te geven. 

### 4. Inspectie
Door een breakpoint te zetten kan de ontwikkelaar het geïsoleerde stuk code inspecteren en zo het probleem onderzoeken. Een alternatief is om waarden in de console te printen.

In Visual Studio is een geavanceerde [Debugger](https://learn.microsoft.com/en-us/visualstudio/debugger/debugger-feature-tour?view=vs-2022) ingebouwd.

### 5. Oplossen
Het beste advies om problemen in code op te lossen om de problemen niet te veroorzaken. In de zin van: voorkomen is beter dan genezen. Robuuste code schrijven en tijdig testen is beter dan steeds te moeten debuggen. 


## Tenslotte

Naast de genoemde mogelijkheden nog twee extra strategieën om het debuggen te vergemakkelijken:
- *statische analyse* van de code. De code wordt gecontroleerd zonder dat deze gestart wordt. De code wordt als het ware gelezen en op grammatica gecontroleerd. Hiermee kunnen allerlei ook ingewikkelde fouten gevonden worden, zoals memory leaks. Meer hierover in deze [blog op Hatica]([Types of Static Code Analysis: Benefits and Limitations - Hatica](https://www.hatica.io/blog/static-code-analysis/)).
- een geavanceerde techniek is het maken van een *memory dump* om de waarden op het moment dat het probleem zich voordeed te inspecteren.

